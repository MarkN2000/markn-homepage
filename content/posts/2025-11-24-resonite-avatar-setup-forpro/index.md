---
title: "Resonite玄人向けアバターセットアップ方法"
date: 2025-11-24T15:00:00+09:00
draft: true
thumbnail: "thumbnail.webp"
thumbnail_alt: "Resoniteアバターセットアップ"
tags: ["Resonite", "解説", "アバター"]
description: "Resonite玄人向けのMarkN流アバターセットアップ方法について紹介します。意図しない動作をさせない・他人のFPSを低下させない（軽量化）ことを重視しています"
---

こんにちは、「まーくん。(MarkN)」です

この記事では、Resoniteの玄人向けにMarkN流のアバターセットアップ方法を紹介します

## 目次
- [はじめに](#はじめに)
- [NoIKの設定](#noikの設定)
- [椅子で腰がひっくり返る](#椅子で腰がひっくり返る)
- [椅子やフルトラで首が伸びないように](#椅子やフルトラで首が伸びないように)
- [極端なスケールにならないようにする](#極端なスケールにならないようにする)
- [モデルインポート](#モデルインポート)
- [アバタークリエイター](#アバタークリエイター)
- [コライダー](#コライダー)
- [指先のタッチ判定位置](#指先のタッチ判定位置)
- [レーザーのヒゲの奥行きを合わせる](#レーザーのヒゲの奥行きを合わせる)
- [スカート貫通](#スカート貫通)
- [ボーンを掴んだり伸ばしたりできるように](#ボーンを掴んだり伸ばしたりできるように)
- [FPSと距離に応じて軽量化](#fpsと距離に応じて軽量化)
- [落下時やアバターを持ったときに足が頭の上まで上がるのを防ぐ](#落下時やアバターを持ったときに足が頭の上まで上がるのを防ぐ)
- [LOD](#lod)
- [バウンディングボックス](#バウンディングボックス)
- [アイトラッキング](#アイトラッキング)
- [フェイシャル](#フェイシャル)
- [表情切り替え](#表情切り替え)
- [足の接地](#足の接地)
- [未使用ボーン・シェイプキー削除](#未使用ボーン・シェイプキー削除)
- [メッシュベイク](#メッシュベイク)
- [テクスチャ](#テクスチャ)
- [マテリアル](#マテリアル)
- [ロコモーション](#ロコモーション)

## はじめに

私が間違えて理解しているところも多々あると思うので、この記事を盲信しないでください

この記事のセットアップは主に 意図しない動作をさせない・他人のFPSを低下させない ことを重視しています

具体的な実装方法までは解説しきれていないところも多いので、以下の私がセットアップしたアバターを分解しながら読むことをおすすめします
<a href="https://uni-pocket.com/ja/items/cd78af9f-3f05-4da8-b499-a477111c2f8f " class="dynamic-link-card"></a>

また、Resoniteで作業する際はこまめにインベントリにバックアップを保存するようにしましょう

これらのサイトも参考になるので是非目を通してみてください
<a href="https://wikiwiki.jp/resonaito/%E9%80%B8%E8%88%AC%E4%BA%BA%E5%90%91%E3%81%91%E3%82%A2%E3%83%90%E3%82%BF%E3%83%BC%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97" class="dynamic-link-card"></a>
<a href="https://wikiwiki.jp/resonaito/%E3%82%A2%E3%83%90%E3%82%BF%E3%83%BC%E6%9C%80%E9%81%A9%E5%8C%96Tips" class="dynamic-link-card"></a>

初心者の方はネット上の初心者向け記事を参考にするか、Resonite内でメンターなどに手伝ってもらってください<br>
この記事で紹介するのは応用的な内容ばかりですので、おそらく何を言っているのかわからないと思います<br>

<b>初心者の方はこの記事は無視</b>して、まずは簡単なところから楽しく気楽にセットアップを楽しみましょう

## NoIKの設定
アバターのボーンがResoniteの推奨する構造・命名になっていない場合はBlender等で直しましょう

UpperChest等があるとhipsの位置を誤認してしまいます<br>
不必要なボーンがある場合はボーンの名前に `<NoIK>` とつけることで無視させることができます<br>
例：`UpperChest<NoIK>` `UpperChest<NOIK>` `<noik>UpperChest`

![alt text](rapture_20251126191101.jpg)

表記がResoniteの推奨に合っていない場合も書き直しましょう<br>
例：`ヒップ`や`hip`⇒`hips`

表記と位置が合っていない場合はいい感じに辻褄を合わせましょう<br>

### Resoniteが推奨する構造
![alt text](<https://wiki.resonite.com/images/5/53/IK_Rig_Bones.png>)

詳細を知りたい場合は公式Wiki参照
<a href="https://wiki.resonite.com/Humanoid_rig_requirements_for_IK" class="dynamic-link-card"></a>

### hipsの位置を誤認している例

足元にhipsがあるので椅子に座ると浮く
![alt text](<2025-11-24 17.17.42.webp>)

hipsとspineの距離を元にhipsコライダーを生成するため、足元から胸あたりまである巨大コライダーが生まれデスクトップモードで手が浮く<br>
![alt text](<2025-11-26 19.51.29.webp>)

## 椅子で腰がひっくり返る

hipsボーンとspineボーンが十分離れていないと<br>
椅子に座った際に少し頭を下げるだけで腰がひっくり返ります
![alt text](<2025-11-24 17.16.11.webp>)

blender等でhipsをspineから離しましょう

元の位置 ほぼ重なっている

![alt text](rapture_20251126180359.jpg)

blenderの編集モードでhipsボーンを少し下げる

![alt text](rapture_20251126180459.jpg)

きれいに座れるように

![alt text](<2025-11-24 17.20.55.webp>)

## 椅子やフルトラで首が伸びないように

何も設定していないとよく首が伸びる（伸びて見えるのは自分からだけ？）

![alt text](<2025-11-24 17.19.15.webp>)

アバタールートにある`VRIKAvatar`コンポーネントの<br>
`HeadMaxFixDistance`を0.001のように小さな値にする<br>
（画像だと1E-07つまり0.00000001になっている）<br>
（0にしても良いと思う）<br>
こうすることで伸びなくなる

![alt text](<2025-11-26 17.19.45.webp>)

## 極端なスケールにならないようにする

アバタールートやMeshRenderer、ボーンのスケールが1に近い値になるようにしましょう。あえて1以外にするメリットはほどんどありません

スケールがバラバラだとアウトラインの幅などがバラバラになってしまったり、ボーンの中にスロットを入れる系のアイテムの一部で問題が起きたりします

![alt text](<2025-11-24 17.28.00.webp>)

アバタールートのスケールが0.01などになっている場合は一度blenderで開きましょう

まずはblender上で大きさが0.3~2.0mくらい(使用予定の身長に近い値)になっているのを確認して、<br>
なっていなければスケールを変えてスケールの適用をしましょう

![alt text](rapture_20251126180724.jpg)

エクスポート形式はfbxが無難です。<br>
本当はglb(gltf)をおすすめしたいのですが、アバターの場合シェイプキーで法線が崩れがちだったりとイマイチ挙動が理解できていないのでアバターに限りfbxをおすすめしています。

fbxでエクスポートをしようとすると以下の画像のような設定が現れるので<br>
画像を参考に設定してください

- 内容はカメラやボックスが含まれないようにいい感じに設定してください<br>
- スケールを適用は FBX単位スケールにしてください<br>
- 向きは -zが前 +yが上 です<br>
- 三角面化はこの段階ではしない方がいいです<br>
- リーフボーンは基本的につけなくていいです。アバター作者さんがいい感じに作ってくれているはず<br>
![alt text](rapture_20251126181444.jpg)

## モデルインポート

自分のスケールを1にしてインポートしましょう

基本的にはユーザースケールでインポートしましょう

アバターのアセットはスロット内に入れましょう

## アバタークリエイター

アバタークリエイターの頭や手の位置はギズモやインスペクターでの数値入力で動かせます<br>
ドライブされているので動かせないと思いがちですが普通に動かせます

グラブして動かすよりも正確に移動・回転できるのでおすすめです

動かしてもよいスロットは `Headset` `LeftHand` `RightHand` `Tooltip` `Shelf` `Grabber` です
![alt text](<2025-11-27 17.51.41.webp>)

ヘッドの位置は2つの丸い玉を基準に考えてください<br>
この２つの丸い玉の間がViewPointとなります

高さはアバターの目に合わせ、前後は鼻先と同じくらいにするのがおすすめです<br>
ここは好みが大きいので自分の好みを探してください

ヘッドの位置を変更したら、もう一度アバタークリエイターのボタン6個を押し直すと安心かも？
![alt text](<2025-11-24 17.34.19.webp>)

アバタークリエイターを小さくするとグラブエリアが小さくなってものがつかみづらくなってしまうので<br>
基本的にアバタークリエイターのスケールはそのままか、変えるとしても少し小さいくらいが良いでしょう（手の大きさを合わせる必要はない）

ツールの位置はデフォルトから変更しない方がおすすめです<br>
ツールの位置を変更してしまうとコントローラーに対するレーザーの位置や向きが変わってしまいます<br>
アバターを着替えるたびにレーザーの位置や向きが変化すると直感的な操作が難しくなるため、基本的にそのままにして、動かすとしても回転はいじらない方が良いです
![alt text](<2025-11-24 17.31.51.webp>)

## コライダー

アバターのコライダーは、掴む際はもちろん<br>
銃のあたり判定<br>トマト投げのあたり判定<br>アバターをよじ登る判定<br>体に落書きするときの判定<br>自動ドアの安全機能<br>
など色々と使われているので、しっかり設定しましょう<br>

コライダーを可視化すると調整が楽になります<br>

また、アバターのコライダーは距離に応じて切り替わります
アバターを着ている側のスケール基準で2ｍ以内だと全身のコライダーがアクティブになり、
2m以上離れると全身を覆う1つのコライダーのみになり処理負荷の軽減が図られています

後からコライダーを追加してしまうと離れた際にオフになってくれないので、
もし追加した場合はコライダーを`rigCollidersEnabledStates`に追加して、離れたらオフになるようにしましょう

こちらのサイトで詳しく解説されています
<a href="https://wikiwiki.jp/resonaito/%E9%80%B8%E8%88%AC%E4%BA%BA%E5%90%91%E3%81%91%E3%82%A2%E3%83%90%E3%82%BF%E3%83%BC%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97#hd62314d" class="dynamic-link-card"></a>

調整前：腰コライダーが小さかったり、手のコライダーが傾いていたりする。外側のコライダーも少し大きすぎる
![alt text](<2025-11-24 17.25.46.webp>)

調整後：いい感じ
![alt text](<2025-11-24 17.24.37.webp>)

## 指先のタッチ判定位置

デフォルトだと多くの場合指先のタッチ位置が関節にあり<br>
指を貫通させないとボタンが押せない<br>
（リーフボーンをつけるなどして指先に指の名前がついたスロットが存在すれば自動で指先にタッチ位置がくる）

このように指を貫通させないとボタンが押せない
![alt text](<2025-11-24 17.50.24.webp>)

人差し指の`TipTouchSource`コンポーネントがついているスロットを探し、そのスロットの子供に新しくスロットを作り指先に移動させる<br>
`TipTouchSource`がついているスロットにあるコンポーネントをすべて新しく作ったスロットに移動させる（コピーではなく移動）
![alt text](<2025-11-24 17.47.19.webp>)

これで指先でボタンが押せるようになる
![alt text](<2025-11-24 17.49.47.webp>)

## レーザーのヒゲの奥行きを合わせる

アバターのスケールによってレーザーのヒゲが出る位置が前後にズレてしまいます

アバターを着てスケールリセットした状態で位置を調整しましょう<br>
`hand`の中にある`Tool Anchor`のスケールを調整することでヒゲの位置が変化します
![alt text](<2025-11-24 17.44.40.webp>)

調整するとちゃんと真横にでるようになります
![alt text](<2025-11-24 17.43.23.webp>)

## スカート貫通
Resoniteで貫通対策をちゃんとやろうとするとめちゃくちゃ大変なので、比較的簡単にできる方法を紹介します

こんな感じにしゃがむとスカートが足に当たって持ち上がります
![alt text](<2025-11-24 17.52.47.webp>)

どうやっているかというと、クソデカボーンコライダーを足につけています
![alt text](<2025-11-24 17.53.51.webp>)

横のスカートが足より内側に来ないようにこのようなコライダーもつけています
![alt text](<2025-11-24 17.57.22.webp>)

## ボーンを掴んだり伸ばしたりできるように
アホ毛引っ張ったりスカートめくったりしたいですよね
![alt text](<2025-11-24 17.59.36.webp>)

DynamicBoneChainコンポーネントの `IsGrabbable` にチェックをつけると掴めるようになります。
`MaxStretchRatio`を1以上にするとそれだけ伸びるようになります
掴めないと際は `VisualizeColliders` にチェックをつけてコライダーの球体が小さすぎないか確かめてください。コライダーの半径を設定する項目もちゃんとあります
![alt text](<2025-11-24 18.00.47.webp>)

## FPSと距離に応じて軽量化

`DynamicBone`はそこそこ計算負荷があるうえに、fpsが低くなると荒ぶります<br>
（大人数の集合写真などでスカートや髪が痙攣したようにブルブルするやつ）

ですので、`ValueGradientDriver<bool>`と`ValueMultiDriver<bool>`を組み合わせて一定以下のfpsになったら`DynamicBoneChain`コンポーネントのEnableが切れるようにしましょう

余裕があればEnableが頻繁に切り替わってかえって負荷が増えないようにヒステリシス制御（20fpsまで下がったらoff、25fpsまで上がったらonというように行き帰りで切り替え地点を変える制御）を導入しましょう<br>
`booleanValueDriver<float>`で`ValueGradientDriver<bool>`のPositionをドライブして、`booleanValueDriver<float>`のstateを`ValueMultiDriver<bool>`でドライブしてください

見ているユーザーのfpsによってDynamicBoneのon/offが変化する様子
![alt text](<2025-11-26 15.11.13.webp>)
![alt text](<2025-11-26 15.11.23.webp>)

距離でのon/offも実装したい場合はさらに複雑になるので、参考アバター（つみれちゃん）を分解して確認するかMarkNに聞いてください。
![alt text](<2025-11-26 17.13.40.webp>)

## 落下時やアバターを持ったときに足が頭の上まで上がるのを防ぐ

FeetHoverHeightを `0` に<br>
MaxFeetVelocityOffsetを `0.05` ~ `0.00` くらいにする (画像だと `0.03`)
![alt text](<2025-11-26 17.19.45.webp>)

## LOD

画面に対して表示しているメッシュのバウンディングボックスの大きさの割合が一定以下になったら表示しなくする機能です

アバターが画面の3ピクセルにしか映っていないのに時計や指輪などを律儀に描画するのは計算資源の無駄ですし、チラチラ点滅してしまいます<br>
ある程度小さくなったら見えなくなるようにしましょう

`LODGroup`コンポーネントをつけて、以下のような感じで設定しましょう<br>
LODs(list)でAddを押してRenderers(list)に制御したいレンダラーを入れて、`ScreenRelativeTransitionHight`の値をレンダラーを消したい値（画面の高さ？の1%以下になった時に消したければ0.01）に設定しましょう<br>
詳細はこちらの記事を参考
<a href="https://wikiwiki.jp/resonaito/Rendering/LODGroup" class="dynamic-link-card"></a>

## バウンディングボックス

バウンディングボックスはLODの計算や、そのメッシュが視界に入っているかどうかの計算に使用されています
ボーン一つ一つの動きをリアルタイムに計算したりすると負荷が高くなるので、できるだけ数を少なく、計算する回数も少なくしましょう
スキンドメッシュが変形する範囲よりも大きくしてしまうと目に映っていないのに描画をすることになるので、大きくしすぎないようにしましょう

ただ、現在（2025年12月4日時点）スキンドメッシュレンダラーのバウンディングボックスの計算にバグがあるらしく、設定が正しく動作していません<br>
デフォルト設定では正しく動作していそうなのですが、いくつかの設定がおかしくなっています。<br>
まだissue書いていないので誰か書ける人書いてください
<a href="https://github.com/Yellow-Dog-Man/Resonite-Issues" class="dynamic-link-card"></a>

そのため、現在は`BoundsComputeMethod`の手動設定は行わずにデフォルトの`static`の設定のままにしましょう。`Proxy`や`Explicit`などに設定して最適化することが本来は望ましいのですが、バグが直るまでは`static`のままにしましょう
![alt text](<2025-12-03 18.47.05.webp>)

## アイトラッキング

目が既にキョロキョロ動いているのなら視線に関しては特に難しい設定はなく動くはずです<br>
`EyeRotationDriver`の`MaxSwing`で目の可動範囲をいい感じに設定しましょう

瞬きは両目同時に閉じるシェイプキーを使うと片目閉じができないので、左右に分かれているものを使いましょう<br>
`EyeLinearDriver`の`Eyes(list)`をaddで増やすなどして`Left`と`Right`の2つ用意して、`OpenCloseTarget`に左右の目閉じをそれぞれ入れましょう<br>
![alt text](<2025-12-03 19.02.36.webp>)

両目閉じしかなくてもResonite内でシェイプキーを左右に分割することも可能です<br>
`SkinndMeshRenderer`の目的のブレンドシェイプの左側の三本線をクリックするとメニューが出るので、左右がX軸のアバターであれば`ブレンドシェイプをX軸で分割`をしてください
![alt text](<スクリーンショット 2025-12-03 190958.webp>)

## フェイシャル

アバタークリエイターでフェイシャルを設定にチェックを付けていればaiueoに関しては自動で設定されます

チェックし忘れていた場合は`AvatarMouthDataSourceAssigner`コンポーネントを付けて`TargerReference`に、元々ついている`DirectVisemeDriver`の`MouthTrackintSource`の項目名のところを掴んで入れましょう
![alt text](<2025-12-02 21.47.23.webp>)

![alt text](<2025-12-02 21.47.32.webp>)
## 表情切り替え

`StandardController`ノード系を使用した表情設定（表情設定ツールなど）が入力も多く便利ですが<br>
今のResoniteで軽さを求めるのであれば`AvatarRawToolData`コンポーネントを使いましょう

`StandardController`Fluxノードと`AvatarRawToolData`コンポーネントをesnyaさんのMOD`ResoniteMetricsCounter`で比較すると30倍ほどFluxが計算時間が長いです<br>
5000個複製した際のfpsやRenderTimeは以下の通りです（fpsが低い方がFlux）
![alt text](<2025-12-04 17.57.46.webp>)
![alt text](<2025-12-04 17.59.09.webp>)

圧倒的な差があります

比較に使用した実装は以下の通りです

コンポーネント
![alt text](<2025-11-26 23.14.55.webp>)

Flux
![alt text](<2025-11-26 23.07.43.webp>)

`AvatarRawToolData`の使い方は簡単で、コンポーネントをつければアバターを着た際にコントローラーの値がそこで取得されます<br>
ただし使用できるのは`Primary``Secondary``Grab``PrimaryStrength``SecondaryAxis`の5つのみです
![alt text](<2025-11-26 17.23.13.webp>)

これらの値をFluxでシェイプキーにドライブするか、<br>
`MultiBoolConditionDriver`と`BooleanValueDriver<float>`を使って<br>
「`Primary`false &`Secondary`false &`Grab`trueの場合このシェイプキーを1にする」<br>
というようにして制御しましょう（`SmoothValue`などを組み合わせると滑らかになる）
![alt text](<2025-11-26 17.24.20.webp>)

Fluxとコンポーネントでこれだけ差があるのはバグの可能性が高いそうなので、だれかissue書いて

## 足の接地
![alt text](<2025-11-24 18.03.17.webp>)

デフォルトのままだと足が地面にめり込んでいたり浮いていたりするので、ちゃんと接地するようにしましょう

アバタールートに元々ついている`LocomotionAnimationFeetMetrics`というコンポーネントの<br>
`FootHeight`にチェックをつけ、いい感じの値を設定しましょう
![alt text](<2025-11-24 18.04.40.webp>)

## 未使用ボーン・シェイプキー削除

### ボーン削除
`Bone(list)`に入っているボーンが多いと読み込みに時間がかかります<br>
未使用のボーンはボタン一つで削除できるので削除しましょう<br>
`SkindMeshRenderer`の下の方に`空のボーンの除去`というボタンがあるのでそれを押してください
![alt text](<2025-11-26 15.27.06.webp>)

### シェイプキー削除
シェイプキーも数が多いと読み込みに時間がかかるので、使用していないものは削除しましょう<br>
`SkindMeshRenderer`の下の方に`使用していないブレンドシェイプを除去`というボタンがあるのでそれを押してください
![alt text](<2025-11-26 15.27.51.webp>)

## メッシュベイク

アバターに`SkindMeshRenderer`が複数あると、それだけドローコールが増え、処理に時間がかかります

普段使いするアバターはメッシュをベイクしてまとめましょう

ただし、現状のResoniteだと顔のようなシェイプキーが多いメッシュを体とまとめてしまうと逆に重たくなってしまうことがあるらしいので、顔と顔以外のように分けるのがおすすめ

グルーツールを`スキンドメッシュをベイク`のモードにして、
![alt text](<2025-11-26 15.54.15.webp>)

ベイクしたいメッシュを一つのスロットの子供にまとめて、親スロットを掴みながらセカンダリを押しましょう
![alt text](<2025-11-26 15.59.44.webp>)

ベイクをするとメッシュのアセットが別のものになるので、devtoolの新規作成のアセット最適化ウィザードを出して
![alt text](<2025-11-26 16.07.28.webp>)

リファレンスにアバタールート（またはAssetスロット）を入れて`使われていないアセットを削除`を実行しましょう
![alt text](<2025-11-26 16.08.07.webp>)

このままだとベイク後のアセットがルートのAsettsスロットに出てしまっているので、ベイクした`SkindMeshRenderer`の`Mesh`の中身を掴んでアバターのAsettsスロットの適当なところにコンポーネントを移動しておきましょう

## テクスチャ

### アルファ除去
アルファを使用していないテクスチャはアルファの除去を行いましょう
同じように見えるテクスチャでもアルファの情報を消すだけでVRAMの使用量をかなり削減できます

テクスチャアセットの下の方に`アルファを取り除く`とあるのでこれを押してください
![alt text](<2025-11-26 16.37.56.webp>)

アルファ除去前 21.33MB（圧縮形式がBC3）
![alt text](<2025-11-26 16.38.16.webp>)

アルファ除去後 10.67MB（圧縮形式がBC1）
![alt text](<2025-11-26 16.39.58.webp>)

### 解像度
自分が許せるギリギリまで解像度を低くしましょう<br>
`再調整`の左にリサイズしたい解像度の長辺をいれて`再調整`を押しましょう
![alt text](<2025-11-26 16.38.41.webp>)

## マテリアル

できるだけまとめましょう

アバターによっては同じテクスチャなのにパーツ毎にマテリアルが別れていたりするので、特別な理由がない限りはまとめましょう

マテリアルの種類もできるならPBS系の不透明を使いましょう<br>
発光しているものにはUnlitを使いましょう

Toon調にしたいところのみXiexeToonにしましょう

透過テクスチャを使っているマテリアルもできるだけBlendMode`Cutout`にして、本当にどうしても半透明にしたいところのみ`Alpha`にしましょう

## ロコモーション

`LocomotionAnimationConfigration`コンポーネントを適当なスロットにコンポーネントをアタッチから新しくつけましょう
![alt text](<2025-11-26 17.16.28.webp>)

`Gaits(list)`の中に0,1,2,3の系4つのパラメーターがあり、移動速度別に別れています<br>
もっとも移動速度が速いときのパラメーターが3なのですが、この3のアニメーションは足が大股で動きすぎなので消しましょう
![alt text](<2025-11-26 17.17.48.webp>)